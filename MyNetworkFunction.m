function [Y,Xf,Af] = MyNetworkFunction(X,~,~)

% ===== NEURAL NETWORK CONSTANTS =====

% Layer 1
b1 = [-0.75526273656807485501;-0.42643877276013558708;-0.17414295084955153103;-1.2359099481580704261;1.8852050001503362076;0.81222521035777861531;-0.17849108069662322773];
IW1_1 = [-1.6518468959415242292;0.78263609166048797583;3.4752147542051519125;1.1964426129336218629;4.3392498119875506646;-1.3005604979964111578;2.3826868680080797169];
IW1_2 = [-0.22519637255440685952;10.2421422795493271;23.39693438971928785;7.1927724409893247781;18.430944215607944159;-19.253853208941563935;2.8437369825830920433];
IW1_3 = [-0.31149681072328072595;1.0014882062263794626;0.5396578369401781039;0.64176649441014532727;-1.2758053731534924058;0.33312402656136647083;0.62934030656540529414];
IW1_4 = [1.8816596145125539241;1.565442963421519007;-0.80805290441022747938;0.36799159401461173369;0.77140367530793219064;0.68775979173160139979;0.336125935485893923];
IW1_5 = [0.096845346040106597418;0.47716821910034618037;2.3621530790963531921;-0.73435742310592166948;-0.022732320680886895781;2.5131462464743372642;-2.2498110561382667072];
IW1_6 = [-8.2904529208307735644;-8.932737345875919388;1.6215601991484320799;10.691361745998444022;-2.867069180635221759;-2.16756523815160973;-6.5776433030497001297];
IW1_7 = [0.85984580543438293709;-1.4574608822845704914;-0.085553628436183956629;-0.45804738012235268751;1.1776696757504598878;-0.036133215799466288087;-0.34263196504461074232];

% Layer 2
b2 = [1.521590161402037289;-1.9845523968325518016;-0.70310950833732088761;-3.7299266019110728365;-0.63288021155380425053;-1.5044654319947308174;-3.6080909289596854173;-9.7427724176814969326;-0.14267198034921937944;1.6442484751291008838;-1.211343076907143157;-5.1364532874725492562;-6.1946765192902271124;-12.152561510038417225;-2.9729753975645620834;-1.4365421549539867385;5.054521728164496075;2.940467575434297931;2.5496691702496803167;-4.4378941692682287723];
LW2_1 = [-0.39425070087083857739 1.8709224825240635681 -2.2876189381131024625 -0.62224540327379973537 -4.7985426810004216946 0.62620330333765761299 -1.6152491282472027923;0.9551329814661245754 -0.60988129824612191676 1.0687457477568589326 0.49663218469117803577 -0.91762966788256683515 0.42483932508136584838 0.95664315482760342579;-0.38045600117066347146 -0.37773359900185093929 0.39430379757280553665 -0.72094191765568238495 -0.39439083916464084956 -0.33063771726886503899 0.18555523169325569;-0.83139908874639945058 1.4442628595501676436 3.0401905979074013153 -1.3815135736664034827 0.97939621381577435244 4.2649789924633054738 -4.2459787447631009982;0.2414865662156771009 0.20850706861603543474 0.50739779743028434744 0.082041758917906479343 0.079878203471516959211 -0.6667274622774098658 -0.18435265158200225821;-0.032222686790170242122 0.15465260646416248425 0.42406647771897676424 0.16993748942018360726 0.33086672358514768177 -0.30732223295098987093 0.079346636457215749538;0.46434862932176651507 -0.29457457109401463669 -0.62253205529800270668 0.13858782881361730865 -0.91232633061987911116 -0.011675933918079722806 -0.7443796732008377548;-3.046414883889517089 -1.9380180671144358051 -3.9927005465291642849 -0.36644169874127524578 0.36973203257684744694 6.5249198540378987587 2.6691279496622999368;1.2060241970295044744 -10.541336390866648642 -23.772944815726145151 -7.2206933468576730561 -18.780607142816513999 19.223164352946863431 -3.1278224818070352597;1.6497278214411421615 -2.1460792100325125631 0.8643179333045174495 -0.86311015299710358573 1.4775502025627627045 0.78182442174940769419 -1.2449785548147276337;0.0034647373463790476916 -0.016783637465862821098 0.00072190047303482586527 0.10086323620875276008 -4.2668100304769724306e-05 -0.014171487638076843071 -0.051576886172923171181;-0.19548909363579175524 -0.24109999946751811684 -0.26142497861685742855 1.3388847721401160307 0.18249146055454118498 0.16732127893387488404 -0.58591081465780381343;9.2204545365425989445 10.264296982469092612 -2.4491583037501230002 -10.770440109095615 3.6302289259145532618 2.8031266014080102877 6.8810878767799765754;1.2229864559853593775 0.047876501427758989815 0.27547476993004882395 1.2734091180934701271 -0.95836590947297806142 -1.7562749237114525513 -2.0146745529988141499;1.6155794457441774448 0.54372490306225385037 3.4230455499943670539 1.7276099243812705897 -3.7833639177531281916 0.53197390058566995652 2.3689656979377873292;-0.040127765026631768974 -0.044254753867013447988 -0.04770442088255282681 0.24563871474614046297 0.033672060756797052294 0.027811469161001429323 -0.11364300106516189715;2.9353230771434528634 -3.4407220522981218913 0.98816892248681797994 -0.22612848885593100912 0.70528256083634177642 -0.006070101901077148282 0.54968370981458669622;0.68259578820324517956 -0.77313303911365049981 -0.6208915225612084976 0.63250918567237657264 -0.61922575658607625915 -1.2680914143036075004 1.7480543209331327326;2.9937189364177725359 2.9469457629720907654 -3.1231411632897723152 5.7438231158034751545 3.1257685316411474297 2.6651504161282018046 -1.4587816996270843717;-0.42491685439336357444 0.22160829252039171422 -0.75700330650316172143 -0.10810423487899470385 0.32530221717759444378 -0.54245472171943853734 -0.089748920360334730195];

% Layer 3
b3 = [-4.4013854900656204094;6.1118242354343887968;-2.7357615430724457894;-5.9625764407128665212;2.1454062842528989208;-0.80790270679894304884;-16.859500670235959774;2.1499401526330883527;0.57978613920934840564;-18.054276313860750491;-0.0071949950996902456782;4.2403021136426710669;3.3632673555411254362;-0.83581548188292087431;1.6285778710543372672;0.14568964243292445437;4.9594491828822979684;-2.0807667546908041878;0.89858152944689739794;-1.8347696328473752647];
LW3_2 = [-0.23005044574690070025 0.2794620570420376926 0.26362184564709489898 0.95542282847308801497 1.2071642943872569198 -0.57873351113204518636 -0.22278373862208744605 0.29464872397969910089 -2.5241227694877350629 0.49769888879982904228 1.5076123690276463929 -2.1052219496061717052 1.2473441542547263339 -0.87708573697235014954 -0.013107279607494743204 6.2459159747041717026 -0.82879912399428368186 -0.0094163991944811436391 -1.2275328061899348775 -0.1580134333070319641;0.26411789040719452215 0.56251058540130116636 0.3358004336983792526 0.81351558742362328758 -1.4941205473546692595 0.20043636540859915973 10.152461770443203193 0.54299915670251508448 -1.5174805851414374658 -0.12566458111795214547 -15.996815053965212527 4.7577448007154687915 -1.4128981098251296444 -1.2156520167850366487 -0.35104638969076645827 -9.4012180754083551903 -0.012863315015844698982 0.036142228899328124325 -0.89037298873352244133 -1.0321096484941603144;0.039754654269519122678 -0.86358131073420063561 -0.63320707851764534979 -0.7201949742711762914 1.3672021594929517629 -1.8564771847574130792 0.59596322323002581811 -0.97482295142937525068 -2.4218180889374956166 -1.1462878568432688375 0.78346381563307387896 0.83744141161943730367 0.093252312343257079408 0.97344502566718682512 -0.27632082249392020401 -3.222047935500724325 1.6077654241303798166 0.082278095045571875144 4.2479259890850196157 0.93638804432173883274;0.47084442463590897576 -0.850253156887958772 0.20427101885148693516 -1.0740346191489824612 -2.6989795532583298332 -3.1223971669539594131 25.938199824239266178 7.2361215756693875178 8.7688947262079803835 -1.2453450237334653394 2.8989700265254354505 -0.64691384660082662528 -4.2463975451632061109 -15.433027582007456502 -1.7491459975393450765 -2.5322244769484765214 2.1285181868996323473 0.048105777954818983166 0.4507979765761683244 1.0699968898931266903;-0.46509007041531852389 -0.51082241657385318856 -2.9425673300175465563 -0.57546775044885345451 0.31091202926792754768 -0.28137647927101072653 -0.94085384053475473731 5.8609617450437685449 -0.49650089505161243419 -0.2623955455164709849 -0.49562150048084685494 0.51784544453815328779 0.26194255460956583637 -0.45386291327412620067 -0.0010989603152713827393 -0.89081488203784142677 0.44168102927060448604 0.056307331873290289437 1.2266116373276816365 -0.06524875430971262269;0.21300654909516772428 0.90484335940620286287 6.0943351134698016125 0.80548988827620593423 0.80311409503639019647 -0.3326752518094546196 0.38166236388789814837 -4.5301051595573307296 0.4425649468960636268 0.68183037289982728613 1.7596347989539802281 -0.13673854432708848483 -0.38213863439870604521 0.16602290881083231477 0.26686284561480916322 -0.81060603370242145793 -1.0097732684131353054 -0.11086743823213845994 -2.3744318476600438927 -0.78961579145221116871;-0.31825017998855054113 0.22187383299574184314 -0.14388768316225206134 1.7754356863996634264 -0.25126943129965884083 7.7235113756538327223 -3.1902134786409663825 28.95582380430174041 9.7603920265314716431 0.32615229277355789472 -5.8993336868658747818 1.2022522292495090301 -0.5246949612021599707 3.0838311505123647827 2.0934793034575198689 1.9606682574786740147 -1.0416644544035307263 -0.013719562677933167319 0.30619965108348634608 0.41180898338873478393;0.25745214674449928838 -0.57077875585052473273 -0.09210696753830865946 -1.9109561430111650093 -3.331591747933814851 2.2607986431033042507 1.7171429875815373833 -1.9192034150257708536 -16.06958652911546892 -0.85002420304681258756 -6.2920824938847008667 -1.30116251956983775 0.25049468480475972632 -0.56351329218309276214 0.29326307278820734625 6.9157193551352742489 1.4693405292199042123 0.043521356787209017347 1.474503539099190963 0.45655370500369524267;0.010934694043808940861 -0.02889716698489767574 -0.021457135012205506147 -0.55110636346341212999 -0.099126716404438014463 0.104149840352945805 0.011558220965364933083 -0.10058697432867184929 0.086863866325098751386 -0.047598335522744214532 -0.050831342093774961599 -0.047346341555448673288 0.040654913068640524676 -0.029831742502541523654 0.0086596600701463240929 0.21468402985481688239 0.070418923707346703367 0.020513072914108202577 0.033288235496437570959 0.31340618996448982303;0.12407348167734584543 -0.20112180795344947182 0.075096066917040502076 0.34111223625609127241 -0.88679396713532354646 0.86864329643961957217 2.3472463312475979613 1.5069661938482477037 -5.7452439537309301087 0.18306261919655786308 12.027148268450766011 13.096997034285841721 13.380814852646414792 -1.001951517825336424 -0.31867789325908263409 -4.0343174233005356655 -0.41583405584910060337 -0.046832253568644024999 0.36929294541689450249 0.79620727356734022351;0.061229343133312782999 0.21749718469022871759 0.13766211421229185285 0.50962299398239541137 -1.7410296369361188962 1.5462472110877258924 0.022209520228696318783 0.90181733481375980777 2.3812116818647881544 0.17352640320959444864 -1.9202208426283744469 -0.81937573256800566579 0.30389656397007630551 -0.54206519158054022878 0.077278022965134932076 3.7952029381479035486 -0.24132549426973415319 -0.0036266621470931368308 -1.1263536998695966584 -0.1766202856830851875;0.08925377335946536872 1.0036941552954179446 0.24875597842542340743 1.7355150870605791091 0.54711806249867867002 -0.89211335873686015141 2.1536848665619796606 -1.9899314088934092482 2.3269866130348999533 1.2533058097322997693 -2.0893300524968938525 2.1174709969894709438 -0.028498795716668388206 0.49156401262967325261 0.033560451679038129369 -5.3763030399891595934 -1.8523851039755168113 -0.079277042784168735845 -3.0633973197176893599 -0.792255793680255338;-0.43831365168723962489 7.4460897238290897349 31.30443800641972274 8.4894453501039173204 9.9380796410906651062 -3.5005382906634894269 -3.6843995022650473103 -15.255410834967138456 -23.211192401793102391 8.8782467622812841768 25.800856349404782009 -0.99211678144233250709 -2.9796357463535194654 -0.14086135841035027361 0.74994200903228669386 -10.056424512680592898 -12.884985924027128945 -0.95014750277346748941 -21.211151494355686253 -8.3604992405353311113;17.655592510576354925 5.4799043621721921227 -0.83605092199030539568 -11.869176181999394615 9.9771167411334733544 -3.1192874649470638815 -1.3425285281793180037 -40.874482853340694533 -2.6258160513350348175 -16.41175170274036077 9.7136522730661383207 0.54776252270747582962 0.056356806397880120085 -0.27214534562767572767 -21.731431118088671894 -5.3659555703556254258 54.938033499255631398 -2.7284399635927680805 -1.0540285854959436929 -7.3282754974878399068;0.80359942298041309172 6.0229750092145382112 1.5898849456490593557 4.621686634854763831 -5.4153918634167670376 3.8644922860928505592 0.33550391028779097402 0.038309080151539491588 -4.3825624210969866823 15.425000506056928629 23.489856936240443019 1.1107155406904680728 0.73921051197159326485 -1.3374056915897132303 10.705940792616452484 -10.112916481859457463 -33.853057916112476278 0.95848784878703841006 -1.8197481866134272988 1.8301847084643272368;-0.48217080822331198631 -1.5551749530946725741 -1.9923673418772243071 0.013166623035888648519 36.228381305829095993 -11.493390919834453712 21.283236804108970119 -5.9399528117779540892 5.1643066442029494922 -0.76639179658710487875 -3.3759764355278938375 0.63369428525794180285 0.75289542708062751064 -14.885547285795263761 0.50590185083673921973 -4.9477517918086544313 0.59974240596112649015 0.0014907839259072528607 -2.1179275993520110255 1.9280997610698988876;-0.43714065423727199722 3.4119727852271029001 0.16917174142012453286 3.4154219286846680959 -2.7494845742062468119 2.9645832848814150928 2.8970903596719383977 -5.2344440236863940541 -9.7809999857070266671 5.5298020098994697946 -4.2853404281087650318 0.13563979272920709263 0.24580508148901461518 -1.0892819815175394105 -2.8498732303094715945 0.83036071925974852537 -7.5354557383871352272 -0.2968597468466152578 -1.871774263202435673 -3.5696073478348213648;-0.50356025637396029104 0.34410500653267328541 -0.023631982753818094045 1.6635227575498054975 -3.8904540274320300597 5.2158645481078629302 3.9614068329631835219 -0.53587618615745558071 -5.0536574109517564679 1.0363155609584486783 7.047823389153057505 -4.1320236579355817952 7.7384440536770089381 20.199212487138208161 -0.30959281395600901643 9.2104876859489710483 -1.775466622922658555 -0.042154461372668608488 -2.4403002543458320872 -0.84862573762613857653;-0.27483696081117958698 -1.2440602295409015632 -0.4331844212231730773 -2.4682292384212760616 2.7360784824693928918 -2.0985655071117239601 -1.1523171425284290947 -3.6218928570633028841 -5.1694855923195879299 -1.7217852614777056086 -1.9298678198118428551 -1.3940603279904750789 0.099372614702608760839 -0.84356043767440569425 1.1570079768370331585 4.3170977078211887346 2.6458972124392050596 0.1016415495681178699 0.67604366729756160126 0.12946521476781908122;-0.1127812381757074961 -0.54644981034516149077 0.26756170872173190567 -0.0039589352714475764539 4.8557746658795775119 -5.4301277104628091763 0.11754087528687093278 -2.0870345097941207513 3.1431600082244601779 -1.68068549613102447 3.9279948661823858025 -7.1812991634134224483 1.1431877682225706216 -1.450940851720074809 0.62620776260692501136 -5.1326817708614189684 2.5607311276281801149 0.19456938792066463817 0.21266361338220757249 -0.6049468312324093322];

% Layer 4
b4 = [1.3034562673851612935;-17.864746182328076429;-15.105442095542509051;-1.5614507194798450396;-9.6938206702692486516;-1.1684019862133439016;11.614632254117799093;-11.941939597134304307;-4.5515492358539129114;-11.09515160199464745;-2.1888921976416280124;-0.096523270109145742346;-1.8877605910800787647;2.7529751580542178857;-8.8944028078222068245;2.481463526510924833;17.492012792631086882;1.3917074198474721491;7.8456759512724607575;-3.1180600975280783338];
LW4_3 = [0.65693531566109819586 -0.11249362774116170027 -1.8283451891705899683 0.37833249896990212013 -1.0336993612130105369 0.21561026883788558806 -0.78389344028256602304 -0.64753303855372124076 -1.7558676467522300602 0.62440475363824243793 -3.0707173659071127503 -0.3960604296857975215 1.7745522804005458006 0.38175976154042373656 0.011644237372249711948 0.1422041254532652732 0.24392717827604593062 -0.024834894718618046733 -0.1956979755617347938 -0.012756858919923697374;16.082352844814014503 9.9295738914157549715 6.5212932327304802271 5.5288679181266031648 -2.3596555697402812335 -4.7865064846001788013 18.754871641130474558 7.1171226792017785456 6.7344453636394234763 -14.245827217753474159 -0.42221058326140925576 6.8313895828202362281 -8.234561214369975346 -1.1371396975160363851 -2.7460030446105743174 -1.8228388839883602479 -4.0778308522745998488 8.3384950475189274499 8.0731460198334730194 -4.7094381753131466795;13.183505905595927388 3.2828363391942003702 -3.5214435000438286671 6.6532572902115134639 7.1612362544718441981 0.014378832854014316975 16.221710113067040027 6.6624702652283414039 0.17347255865655122897 -3.4394771543066107178 -19.158085019504856206 3.2161469139497742553 0.60450755325551908115 -3.2465157136273403715 -0.26916144209471776216 0.34725697790312270996 3.5859446119810165499 2.5296229062440986901 2.0087557121225754209 -2.2963397246945609353;-0.25725487143410302737 5.0076550783467208561 5.1508528810544156329 2.0796302978419922702 -1.8650899904330511259 1.2177993994634037644 -5.8832340606653765747 -11.037139640361292692 -2.428606510462679946 -7.9106394433560476287 6.1699724024508437736 0.09369739221246146943 3.2965375096983287051 5.8942283144314595589 -0.61755475978650431479 -1.0666250189933246251 2.5311958759648733874 5.9177001534045716724 2.1357766065573966507 -4.2184084688200922386;-5.6676820659384157253 -2.0744931032983253694 -5.6556495739727337124 -6.63132518544658911 10.342029389045364951 1.0342240965345304016 -0.29680170683006279475 1.1350810262655626204 -0.92679435419422739884 4.3859252463595508331 -7.6131364741238236604 2.3959808253476926332 1.4622099658464016159 3.8268677814428704309 -1.2135529587933715501 0.38245586111129759033 0.5361516957000487249 -0.37119760238617466319 -0.40649162521391307701 0.9509140215609775959;1.0233286277233588635 0.53901614424113231117 -2.3456130830447698976 -4.589528295052461182 4.2191429916098002195 0.58964594579941664865 -4.9653996069251808976 -3.875923480546500155 0.069507489442208095221 4.3580276456525357531 -3.1045134400409812869 0.76576402517272457171 1.4765940133480750518 -0.15247415629873667386 -1.4097841445141674477 1.1189067515684034682 2.0049000980973197272 -1.7952258888058598707 0.69119391474087921168 0.11254540382743047355;11.631319933855685633 4.0183916378959176896 0.2490311853256760577 2.8673987619968070995 -10.577638645300734055 -3.5725173479999607906 0.91324393475324294744 1.376666680976796231 -0.33639162978506875756 -3.3070277007321107199 -4.4383096231730929659 -4.3383128696935440161 -1.5574351239730279683 -2.7732388127234841591 1.1162899374489423376 -0.4925833572802388316 1.3923150919166749073 0.86245924689983377576 -2.191155041597052211 -0.71040676781550049501;5.5557349343560646915 -17.143190965340757259 -17.214203824409139543 1.7325675015684194324 -6.4605301939631250008 4.4583328210741006714 22.66414774622323236 32.127406262029964523 -7.3375923740535089479 -15.639728083851572649 15.333116081935317609 26.945017691916905989 10.79876342251116661 -42.634964407689693644 26.397116396317066744 11.436695090285523335 -0.84630383497349803701 -21.357131831983728887 -38.801132033262554444 13.297780636324333159;0.37513249057444619794 -0.043712035581290657749 -0.42151475079502270793 0.017061138359369745765 -0.093198644854083523281 0.21713984626188120863 -0.12676275835744588161 -0.087608153025586277263 10.988516561463644194 -0.19081419219192832792 -0.92832284774686835149 -0.21630458676614550129 -0.14732480776211842599 -0.23773919068750845596 0.062053807022125991033 -0.015367847694040820059 -0.06476565371839948515 0.093697979562887653837 -0.43402813526355499274 0.057381259015508008503;-11.895803113995574662 -3.865433904321236902 -0.25499299924823259911 -2.6508962861024203406 10.222714597825111937 3.2163888855952502688 -0.50968410358747684441 -1.3064788356003533831 0.18763983258001382115 3.4716140877043897284 4.6243746746607481413 4.1581140606200852616 1.5730100814962908462 2.7176969869543894376 -1.2722932611763138055 0.33121350732543858308 -1.6798269841105915035 -0.62108518586070093903 2.2694444763928616204 0.85152890260134184164;4.6438264207682644624 1.0489054055595627979 0.5957705492575073869 1.0980974804082668239 -0.057490257973206039532 0.83360178357700032148 0.13137367472854125094 0.070351382059696140892 -3.1132547146568394503 -2.5552539361639485804 3.0191766636095218601 -0.46819135770440312161 -1.4448612117877526195 -0.32333820691658266 0.56238172633531968714 0.46266404411036193833 0.94193895641469005398 0.14526579138464390528 -1.3508113354262769601 0.040574806348865267991;2.8205575605556059138 1.4670692055211635996 -1.8008521616474593152 3.6801693148070211414 0.85835529604106342028 -0.30679842033014403935 0.57138842440109649523 0.59345238297787339388 1.4146705631762477307 0.26052761366450882807 -8.5330591508444975091 -1.555423311991687596 -0.51006144211548265499 4.3495519331420986475 -0.56244170185236175286 0.85238507074869873659 0.65992894073391161758 0.51015249530705086833 0.22595816613613095569 -0.41611839020216467855;1.3363327766573604993 0.45495895116066931152 -2.5640786671668700514 -1.2250179546139179365 2.3873615633156162197 0.14401528858613854567 -0.037363992096088212425 -0.98242405590474268795 -0.21912758023754860814 0.31886703957270334797 -6.1689858685536140825 -0.20973032820907938634 0.68850115766687014496 1.6703541554974383754 -0.010990615257647872241 0.87722585205229475225 0.3454751534941042368 -0.53895846386691304009 0.68126478371597309902 -0.25681932547459745964;-4.926736035514964307 12.51640144303321911 -3.6938844386408389298 -25.318808623018057347 5.1648783835432938716 0.43058113710413425945 -51.620870997595673657 25.718053076117371347 5.3861097695805959518 4.7033908950296554607 6.0136999899182503881 -5.0752602172004070979 0.52242100237826971654 12.722415436474840078 0.034577440726084457401 -0.78116886015205544425 -4.7683442493646701621 -2.2693008861744869975 5.5428267596067453127 -4.0231596936502214135;-0.45421751130527410201 4.6661033137910106205 10.506406685434360071 3.9481424735151353644 -9.3678007298711101214 -0.45640908179160250002 -2.8861519737927960882 -8.1617637365489645873 5.4908501443542689913 7.8671580433827612566 8.6402210358650819444 0.022335705229593896814 -0.23592361477987286444 -0.18018711094006320539 -2.700401235487352114 -0.43783139499976891917 0.35881557769427330218 9.9578703992578159188 4.1978700508441173511 -5.8969167471309864581;0.46644051792893020947 0.30221817589514127222 0.09113433833372329429 -0.7005484893298573601 2.3408451234531186813 2.5717980071143853316 -0.079260536675475376511 -0.036632174795397112743 -2.3171928171212443637 -0.13869475953102550214 0.276136947553878076 -0.95885939355750038349 -2.6072579500620629567 -0.03613840871931011528 0.16450247018255423348 0.21000256553637808299 0.10143532722797288237 -0.10100314911756724801 -0.88002704215120008957 0.12704344585748661434;-15.073741714879298925 -9.5474868143101740969 -6.6972427064683550668 -5.4135109847148656925 2.6102941101579975047 5.3167243646736288554 -18.542733937344305417 -6.8564480687442301843 -7.3003294721525939792 13.671267483984564706 -0.27218904843681984707 -6.6454597009687361719 7.9728509424765183766 1.3018251169474805984 2.6592769402346601026 1.7672305778351766747 3.8482898220221049002 -7.9682485283103128282 -7.9666607099551534077 4.5252590686592730762;8.8386156628358119036 6.6040694710180174454 -4.1218787609497162805 -1.8446368714210084061 -3.4544828849829234407 -2.058331541727965508 -1.3366419346189508666 0.18564101981894234883 8.7417399951801257885 -1.8035866945843410658 -2.1887256915166832805 -7.6871422629686367856 -0.49305080408541407389 4.9799120472490479017 -0.58659622833816060794 2.2317409937193404268 -4.1054302768798827117 4.4059451255163253336 10.869718770926171558 -3.2118676983104568201;-13.729296367822822589 -2.9507716396016587801 -3.5007784381448776578 -12.651191533676310996 -8.4818142365660804671 -4.0478501601606735605 0.92211379603464838084 3.9072737255266378753 3.0291725458842893026 -3.8611414576160054679 -10.86137139644310956 4.8462841144770214541 2.524658519991208383 3.8355730144447690577 -0.10103133410234653444 -5.0078466627846287551 -6.2689777636328187782 7.6104089743078660035 1.3215572232737993197 0.40860079939267096583;-0.51223208011398890793 8.5564446287184470208 -7.4512038814402794529 -3.2551776586430190008 -8.9152637269806724873 -4.5856333453070607931 0.39145147611505354268 9.3749377249147780589 2.9500992273099719831 -7.8219236632647479723 -2.3235191775255916724 -8.0922513620948297586 0.018023618360896241641 9.7191744370638666339 -0.87028017211971564482 11.844224217946539568 -1.3736410171599640062 6.1379917791144107397 0.74508293637227418493 1.5239195148740998231];

% Layer 5
b5 = 1.2404240627583507095;
LW5_4 = [-15.903922055078835385 -3.227899678561459762 -12.214709309718070784 -10.036164787500625906 -0.98949788060558974134 1.2234448647984563774 -9.7105481104080126897 -23.727630556251085636 28.037361949986429721 -9.8477469242973167951 -4.0451230034256093759 2.9238567723470225701 6.1721349835437395726 25.339469054706913909 -0.21794703768940815181 -8.6036950873558879493 -3.2962092922813441831 -9.2247454463695550686 0.23957112999997712266 1.6462711819083939435];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
  
    % Layer 1
    a1 = repmat(b1,1,Q) + IW1_1*X{1,ts} + IW1_2*X{2,ts} + IW1_3*X{3,ts} + IW1_4*X{4,ts} + IW1_5*X{5,ts} + IW1_6*X{6,ts} + IW1_7*X{7,ts};
    
    % Layer 2
    a2 = logsig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = logsig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = logsig_apply(repmat(b4,1,Q) + LW4_3*a3);
    
    % Layer 5
    a5 = repmat(b5,1,Q) + LW5_4*a4;
    
    % Output 1
    Y{1,ts} = a5;
end

% Final Delay States
Xf = cell(7,0);
Af = cell(5,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Sigmoid Positive Transfer Function
function a = logsig_apply(n,~)
  a = 1 ./ (1 + exp(-n));
end
